
# Statistics Service API

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ç–µ—Å—Ç–æ–≤ NIST.

## üìä –û–±–∑–æ—Ä —Å–µ—Ä–≤–∏—Å–∞

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –∏–∑ 0 –∏ 1) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ –∫–∞–∫ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π, —Ç–∞–∫ –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤.

![alt text](../../source/stats.png)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- Redis
- PostgreSQL
- MinIO (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone <repository-url>
cd statistics-service

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

## üìö API Endpoints

### üîç –ê–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π

#### –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä–æ–∫–æ–≤–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```http
POST /statistics/sequence
Content-Type: application/json
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "sequence": "01010101010101010101",
  "sequence_id": "uuid-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "statistics_id": "uuid-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏",
  "sequence_id": "uuid-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏",
  "sequence_length": 20,
  "ones_count": 10,
  "zeros_count": 10,
  "ones_proportion": 0.5,
  "tests_passed": 8,
  "tests_total": 8,
  "success_rate": 1.0,
  "created_at": "2024-01-15T10:30:00Z",
  "tests_results": {
    "frequency": {
      "p_value": 0.85,
      "result": "PASS",
      "details": {}
    }
    // ... –¥—Ä—É–≥–∏–µ —Ç–µ—Å—Ç—ã
  }
}
```

#### –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞
```http
POST /statistics/file
Content-Type: multipart/form-data
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `file`: –ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

**–û—Ç–≤–µ—Ç:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∞–Ω–∞–ª–∏–∑—É —Å—Ç—Ä–æ–∫–∏ + –ø–æ–ª–µ `file_url` —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ñ–∞–π–ª.

### üìà –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ ID
```http
GET /statistics/{sequence_id}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `sequence_id`: UUID –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 30 –º–∏–Ω—É—Ç

### üìä –î–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

#### –û–±–∑–æ—Ä–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```http
GET /statistics/dashboard/overview
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "total_sequences": 150,
  "avg_sequence_length": 1024.5,
  "avg_success_rate": 0.78,
  "bit_distribution": [
    {
      "length_range": "0-100",
      "avg_ones": 45.2,
      "avg_zeros": 54.8,
      "sequence_count": 25
    }
  ],
  "worst_tests": [
    {
      "test_name": "serial",
      "success_rate": 0.45,
      "total_sequences": 150
    }
  ],
  "heatmap_data": {
    "sequence_ids": ["uuid1", "uuid2"],
    "test_names": ["frequency", "runs"],
    "results": [{...}]
  }
}
```

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –î–∞–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥–∞ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç

### ü©∫ Health Check

```http
GET /health
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞.

## üî¨ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã

–°–µ—Ä–≤–∏—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ—Å—Ç—ã NIST:

### 1. Frequency Test (–ß–∞—Å—Ç–æ—Ç–Ω—ã–π —Ç–µ—Å—Ç)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É 0 –∏ 1 –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

### 2. Runs Test (–¢–µ—Å—Ç —Å–µ—Ä–∏–π)
–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –±–∏—Ç–æ–≤.

### 3. Serial Test (–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä –±–∏—Ç–æ–≤.

### 4. Autocorrelation Test (–¢–µ—Å—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏)
–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –º–µ–∂–¥—É —Å–¥–≤–∏–Ω—É—Ç—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

### 5. Poker Test (–ü–æ–∫–µ—Ä-—Ç–µ—Å—Ç)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –±–∏—Ç–æ–≤.

### 6. Cumulative Sums Test (–¢–µ—Å—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã—Ö —Å—É–º–º)
–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ —Å—É–º–º—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

### 7. Longest Runs Test (–¢–µ—Å—Ç —Å–∞–º—ã—Ö –¥–ª–∏–Ω–Ω—ã—Ö —Å–µ—Ä–∏–π)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∞–º—ã—Ö –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –±–∏—Ç–æ–≤.

### 8. Matrix Rank Test (–¢–µ—Å—Ç —Ä–∞–Ω–≥–∞ –º–∞—Ç—Ä–∏—Ü—ã)
–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–Ω–≥ –±–∏–Ω–∞—Ä–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## üíæ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:

- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ ID**: –ö—ç—à –Ω–∞ 30 –º–∏–Ω—É—Ç
- **–î–∞—à–±–æ—Ä–¥**: –ö—ç—à –Ω–∞ 5 –º–∏–Ω—É—Ç —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üóÉÔ∏è –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### StatisticsRequest
```typescript
{
  sequence: string;      // –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ 0 –∏ 1
  sequence_id: UUID;     // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
}
```

### StatisticsResponseSchema
```typescript
{
  statistics_id: UUID;
  sequence_id: UUID;
  sequence_length: number;
  ones_count: number;
  zeros_count: number;
  ones_proportion: number;
  tests_passed: number;
  tests_total: number;
  success_rate: number;
  created_at: DateTime;
  tests_results: Map<TestType, TestResultDetail>;
}
```

### TestResultDetail
```typescript
{
  p_value: number | null;    // –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å
  result: "PASS" | "FAIL" | "WARNING" | "SKIP";
  details: object;           // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
}
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```env
DATABASE_URL=postgresql://user:pass@localhost/dbname
REDIS_URL=redis://localhost:6379
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=access_key
MINIO_SECRET_KEY=secret_key
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- Health check endpoint
- –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫—ç—à-–ø–æ–ø–∞–¥–∞–Ω–∏–π/–ø—Ä–æ–º–∞—Ö–æ–≤
